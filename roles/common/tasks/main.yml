- name: update base
  apt: update_cache=yes upgrade=dist

- name: install base pkgs
  apt: pkg={{ item }} state=present
  with_items:
  - htop
  - curl
  - screen
  - tree
  - git
  - daemon
  - vim
  - rtorrent
  - python-mysqldb

- name: setup authorized_keys
  copy: src=authorized_keys dest={{ pwd }}/.ssh/authorized_keys
  when: cloud

- name: mk vagrant .ssh
  file: dest={{ pwd }}/.ssh state=directory
  when: not cloud

- name: vagrant keys
  copy: src=authorized_keys-vagrant dest={{ pwd }}/.ssh/authorized_keys
  when: not cloud

- hostname: name={{ hostname }}
  when: cloud

- name: fix hostname
  template: src=hosts.j2 dest=/etc/hosts
  when: cloud

- name: add rc.local
  copy: src=etc/rc.local dest=/etc/rc.local
  when: cloud

- name: cloudatcost delete daily cron
  shell: rm -rf /etc/cron.daily/*
  when: cloud

- name: fix dns auto-gen
  copy: src=etc/resolvconf/resolv.conf.d/base dest=/etc/resolvconf/resolv.conf.d/base
  when: cloud

- name: dns auto-generated file
  copy: src=etc/resolv.conf dest=/etc/resolv.conf
  when: cloud